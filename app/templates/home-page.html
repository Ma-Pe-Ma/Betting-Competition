{% extends "layouts/base.html" %}

{% block title %} Blank Page {% endblock %} 

<!-- Plugins CSS goes HERE  -->
{% block plugin_stylesheets %}{% endblock plugin_stylesheets %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
<link rel="stylesheet" href="./static/assets/css/betting.css">
{% endblock stylesheets %}

{% block content %}
    <script>
        var remark_config = {
            host: "{{REMARK42_URL}}",
            site_id: "{{REMARK42_SITE_ID}}",
        }
    </script>
  
  <script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script>


    <div class="container-fluid">
        <!-- ============================================================== -->
        <!-- Bread crumb and right sidebar toggle -->
        <!-- ============================================================== -->
        <div class="row page-titles">
            <div class="col-md-5 col-8 align-self-center">
                <h3 class="text-themecolor m-b-0 m-t-0">Dashboard</h3>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="javascript:void(0)">Home</a></li>
                    <li class="breadcrumb-item active">Dashboard</li>
                </ol>
            </div>
            <div class="col-md-7 col-4 align-self-center">
                <a target="_blank"
                   href="https://appseed.us"
                    class="btn waves-effect waves-light btn-danger pull-right hidden-sm-down">
                    More Starters
                </a>
            </div>
        </div>
        <!-- ============================================================== -->
        <!-- End Bread crumb and right sidebar toggle -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Start Page Content -->
        <!-- ============================================================== -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-block">
                        {% if match_state %}
                            {% if match_state == "invalid" %}
                                {% set text = "Érvénytelen meccs!" %}
                                {% set color = "lightcoral" %}
                            {% elif match_state == "started" %}
                                {% set text = match_id + ". meccsre már nem lehet fogadni!" %}
                                {% set color = "lightcoral" %}
                            {% elif match_state == "group" %}
                                {% set text =  "Végső- és csoportkörfogadások sikeresen beállítva!" %}
                                {% set color = "lime" %}                            
                            {% elif match_state == "nonstarted" %}
                                {% set text = match_id + ". meccs-tipp sikeresen módosítva!" %}
                                {% set color = "lime" %}
                            {% endif %}
                        <div style="background-color: {{color}}; font-weight: bold;" >
                            {{text}}
                        </div>
                        {% endif %}

                        {% with messages = get_flashed_messages() %}
                            {% if messages and messages|length > 0 %}
                        <br>
                            <div>Üzenetek: </div>
                            {% for message in messages %}
                                {%if message != "" %}
                            <div style="background-color:rgb(255, 238, 0);">{{loop.index}}: {{message}}</div>
                                {% endif %}
                            {% endfor %}
                        <br>
                        <br>
                            {% endif %}
                        {% endwith %}
                        
                        <p style="font-size: 20px;">Jelenlegi egyenleg: {{current_amount|round(2)}}</p>

                        <table>
                            {% set day_names = dict() %}
                            {% set dummy = day_names.update({0 : 'hétfő'}) %}
                            {% set dummy = day_names.update({1 : 'kedd'}) %}
                            {% set dummy = day_names.update({2 : 'szerda'}) %}
                            {% set dummy = day_names.update({3 : 'csütörtök'}) %}
                            {% set dummy = day_names.update({4 : 'péntek'}) %}
                            {% set dummy = day_names.update({5 : 'szombat'}) %}
                            {% set dummy = day_names.update({6 : 'vasárnap'}) %}

                            {% for day in days %}
                            {%if loop.index % 12 == 1 %}
                            <table style="width:90%;margin-left:20px;background-color: lightblue">
                                <tr>
                                    <th rowspan="2" style="width: 5%;">ID</th>
                                    <th rowspan="2" style="width: 5%;">Időpont</th>
                                    <th rowspan="2" style="width: 25%;text-align:center;">Csapatok</th>
                                    <th rowspan="2" style="width: 15%;text-align:center;">Forduló</th>
                                    <th scope="col" colspan="3" style="text-align:center;">Oddok</th> 
                                    <th rowspan="2" style="width: 8%;text-align:center;">Tipp</th>
                                    <th rowspan="2" style="width: 8%;text-align:center;">Tét</th>
                                    <th rowspan="2" style="width: 8%;text-align:center;"></th>
                                </tr>

                                <th style="text-align:center;width: 3%;">1</td>
                                <th style="text-align:center;width: 3%;">X</td>
                                <th style="text-align:center;width: 3%;">2</td>
                            </table>   
                            {% endif %}

                            <div id="ID_{{day.number}}">
                                {{day.number}}. nap - {{day.date}} - {{day_names[day.id]}}
                            </div>

                            <table style="width:90%;margin-left:20px;{#%if loop.index % 10 == 1 %} background:yellow; {% endif %#}">
                                <tr>
                                    <th rowspan="2" style="width: 5%;"></th>
                                    <th rowspan="2" style="width: 5%;text-align:center"></th>
                                    <th rowspan="2" style="width: 25%;text-align:center;"></th>
                                    <th rowspan="2" style="width: 15%;text-align:center;" ></th>
                                    <th scope="col" colspan="3" style="text-align:center;"></th> 
                                    <th rowspan="2" style="width: 8%;text-align:center;"></th>
                                    <th rowspan="2" style="width: 8%;text-align:center;"></th>
                                    <th rowspan="2" style="width: 8%;text-align:center;"></th>
                                </tr>

                                <th style="text-align:center;width: 3%;"></td>
                                <th style="text-align:center;width: 3%;"></td>
                                <th style="text-align:center;width: 3%;"></td>

                                {% for match in day.matches %}

                                
                                {% set background = 'white' %}

                                {% if loop.index %2 == 1 %}
                                {% set background = '#E8E8E8' %}
                                {% endif %}

                                <tr style="padding-bottom:5px;background-color:{{background}};">
                                    <td>{{match.ID}}</td>
                                    <td>{{match.time}}</td>
                                    <td style="text-align:center;">{% if match.team1 =="" %} Nem ismert {%else%} {{match.team1}} {% endif %} - {% if match.team2 =="" %} Nem ismert {%else%} {{match.team2}} {% endif %}</td>
                                    <td style="text-align:center;">{{match.type}}</td>
                                    <td style="text-align:center;">{{match.odd1}}</td>
                                    <td style="text-align:center;">{{match.oddX}}</td>
                                    <td style="text-align:center;">{{match.odd2}}</td>
                                    <td style="text-align:center;">{{match.goal1}}-{{match.goal2}}</td>
                                    <td style="text-align:center;">{{match.bet}} / {{match.max_bet}}</td>
                                    <!--input type="image" src="http://example.com/path/to/image.png" /-->
                                    <td><button class="editbtn" value="{{match.ID}}" onclick="redirectToEdit(this.value)">Szerkeszt</button></td>
                                </tr>

                                {% endfor %}
                            </table>
                            <br>

                        <!--/div-->
                        {% endfor %}

                        </table>                    
                        
                        {% if days|length == 0 %}
                        <div style="display: inline-block;">A tipp bajnokság véget ért. </div> <div style="display: inline-block;">A végeredményhez</div> <a href="./standings" style="display: inline-block;">kattints ide!</a>
                        {% endif %}

                        <script>
                            function redirectToEdit(buttonID) {
                                console.log("arg: " + buttonID);
                                window.location = "./match?matchID=" + buttonID;
                            }

                            var url= document.location.href;
                            window.history.pushState({}, "", url.split("?")[0]);
                        </script>

                    </div>
                </div>
            </div>
        </div>

        <div id="remark42"></div>

        <!-- ============================================================== -->
        <!-- End PAge Content -->
        <!-- ============================================================== -->
    </div>

{% endblock content %}

{% block javascripts %}{% endblock javascripts %}
